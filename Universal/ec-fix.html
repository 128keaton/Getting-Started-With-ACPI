
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Embedded Controller Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-medium-zoom/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

    

        
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="plug.html" />
    
    
    <link rel="prev" href="../Laptops/laptop-disable.html" />
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"buttons":[{"user":"dortania","repo":"Getting-Started-With-ACPI","type":"star","size":"large"}]};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Getting Started With ACPI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../ssdt-easy.html">
            
                <a href="../ssdt-easy.html">
            
                    
                    SSDTs: Easy Way
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../ssdt-long.html">
            
                <a href="../ssdt-long.html">
            
                    
                    SSDTs: Long Way
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Manual</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../Manual/dump.html">
            
                <a href="../Manual/dump.html">
            
                    
                    Dumping the DSDT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../Manual/compile.html">
            
                <a href="../Manual/compile.html">
            
                    
                    Decompiling and Compiling
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Desktop</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../Desktops/desktop-disable.html">
            
                <a href="../Desktops/desktop-disable.html">
            
                    
                    Disabling desktop dGPUs
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Laptop</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../Laptops/backlight.html">
            
                <a href="../Laptops/backlight.html">
            
                    
                    Backlight PNLF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../Laptops/trackpad.html">
            
                <a href="../Laptops/trackpad.html">
            
                    
                    Trackpad GPI0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../Laptops/laptop-disable.html">
            
                <a href="../Laptops/laptop-disable.html">
            
                    
                    Disabling laptop dGPUs
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Universal</li>
        
        
    
        <li class="chapter active" data-level="5.1" data-path="ec-fix.html">
            
                <a href="ec-fix.html">
            
                    
                    Embedded Controller
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="plug.html">
            
                <a href="plug.html">
            
                    
                    Plugin type
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="awac.html">
            
                <a href="awac.html">
            
                    
                    AWAC vs RTC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="nvram.html">
            
                <a href="nvram.html">
            
                    
                    NVRAM PMC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="irq.html">
            
                <a href="irq.html">
            
                    
                    IRQ Fix
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="spoof.html">
            
                <a href="spoof.html">
            
                    
                    GPU Spoof
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="smbus.html">
            
                <a href="smbus.html">
            
                    
                    Fixing SMBus Support
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Cleanup</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../cleanup.html">
            
                <a href="../cleanup.html">
            
                    
                    Cleanup
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Misc</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../troubleshooting.html">
            
                <a href="../troubleshooting.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../CONTRIBUTING.html">
            
                <a href="../CONTRIBUTING.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Embedded Controller</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <blockquote>
<p><em>Last modified: Wed May 06 2020 04:52:37 GMT+0000 (Coordinated Universal Time)</em></p>
</blockquote>
<h1 id="fixing-embedded-controller"><a name="fixing-embedded-controller" class="plugin-anchor" href="#fixing-embedded-controller"><i class="fa fa-link" aria-hidden="true"></i></a>Fixing Embedded Controller</h1>
<p>What we&apos;ll be doing is creating a fake Embedded Controller (EC) to satisfy macOS Catalina&apos;s EC addiction, and disabling the EC on desktops to prevent panics and crashes.</p>
<p>For desktops, you&apos;ll want to begin by grabbing either one of these uncompiled SSDT files:</p>
<ul>
<li><a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/AcpiSamples/SSDT-EC-USBX.dsl" target="_blank">SSDT-EC-USBX</a><ul>
<li>For Skylake and newer and all AMD systems</li>
</ul>
</li>
<li><a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/AcpiSamples/SSDT-EC.dsl" target="_blank">SSDT-EC</a><ul>
<li>For Broadwell and older</li>
</ul>
</li>
</ul>
<p>For laptops, you&apos;ll can actually use the pre-builts:</p>
<ul>
<li><a href="https://github.com/dortania/Getting-Started-With-ACPI/blob/master/extra-files/SSDT-EC-USBX-LAPTOP.aml" target="_blank">SSDT-EC-USBX-LAPTOP.aml</a><ul>
<li>For Skylake and newer</li>
</ul>
</li>
<li><a href="https://github.com/dortania/Getting-Started-With-ACPI/blob/master/extra-files/SSDT-EC-LAPTOP.aml" target="_blank">SSDT-EC-LAPTOP.aml</a><ul>
<li>For Broadwell and older</li>
</ul>
</li>
</ul>
<p>With laptops it&apos;s a simple as that, all this does is check for an existing <code>EC__</code> and if one doesn&apos;t appear then create a fake EC to make macOS happy.</p>
<p>Desktops however will need to follow below on creating a proper SSDT.</p>
<h3 id="fixing-the-path"><a name="fixing-the-path" class="plugin-anchor" href="#fixing-the-path"><i class="fa fa-link" aria-hidden="true"></i></a>Fixing the Path</h3>
<p>For Intel systems, the path is <em>likely</em> correct, though it&apos;s worth double checking. You will want to find your current EC by opening your decompiled DSDT and searching for <code>PNP0C09</code>. You should get a result similar to this:</p>
<p><img src="../images/Desktops/pnp.png" alt=""></p>
<blockquote>
<p>Note: If your EC device happens to already be named <code>EC</code> in your DSDT, you do not need SSDT-EC at all and can move on.</p>
</blockquote>
<p>As you can see, <code>PNP0C09</code> is found under the <code>EC0</code> device and <code>_SB.PC00.LPC0</code> scope. Looking at the SSDT though, this differs from the path <code>_SB_.PCI0.LPCB</code> seen within. This will need to be corrected in the SSDT to match what is found in the DSDT. Using the above image, you should get something similar to this:</p>
<pre><code class="lang-text">Scope (\_SB.PC00.LPC0) &lt;- Rename this
{
    Device (EC) &lt;- DO NOT RENAME THIS
    {
        Name (_HID, &quot;ACID0001&quot;)  // _HID: Hardware ID
        Method (_STA, 0, NotSerialized)  // _STA: Status
        {
            If (_OSI (&quot;Darwin&quot;))
            {
                Return (0x0F) // Enable our Fake EC only when in macOS
            }
            Else
            {
                Return (Zero)
            }
        }
    }
}
</code></pre>
<p>Generally, <code>PC00.LPC0</code> is most common on Intel HEDT while <code>PCI0.SBRG</code> is most common on AMD. <strong>Always verify your path and device. DO NOT ASSUME</strong>.
If you are having issues finding the Scope, you can use the below Hardware IDs or Addresses:</p>
<ul>
<li>Finding the LowPinCount path:<ul>
<li>Intel: Search <code>Name (_ADR, 0x001F0000)</code></li>
<li>AMD: Search <code>Name (_ADR, 0x00140003)</code></li>
</ul>
</li>
<li>Finding the PCI path:<ul>
<li>Intel: Search <code>PNP0A08</code> (If multiple show up, use the first one)</li>
<li>AMD: Assume <code>PCI0</code>(most AMD DSDTs don&apos;t declare the PCI path directly)</li>
</ul>
</li>
</ul>
<p><strong>Make sure that you do not rename <code>Device (EC)</code>. This is what macOS Catalina looks for to boot!</strong></p>
<p><strong>Desktop users, continue down below to disabling your actual EC</strong></p>
<h3 id="disabling-real-ec-desktops-only"><a name="disabling-real-ec-desktops-only" class="plugin-anchor" href="#disabling-real-ec-desktops-only"><i class="fa fa-link" aria-hidden="true"></i></a>Disabling real EC (Desktops only)</h3>
<p>For desktops, it&apos;s preferable to disable the actual Embedded Controller as it is not supported by macOS 100% and is known to sometimes cause panics. If we use the screenshot above, we&apos;ll see that the device name is <code>EC0</code>. Other common names for ECs are <code>H_EC</code>, <code>ECDV</code>, and <code>EC0</code>. You&apos;ll want to grab your SSDT again and uncomment the <code>_STA</code> method to disable it (remove the <code>/*</code> and <code>*/</code> around it):</p>
<pre><code class="lang-text">/* &lt;- REMOVE THIS
External (_SB_.PCI0.LPCB.EC0, DeviceObj) &lt;- Rename this

   Scope (\_SB.PCI0.LPCB.EC0) &lt;- Rename this
   {
      Method (_STA, 0, NotSerialized) // _STA: Status
      {
         If (_OSI (&quot;Darwin&quot;)) // Darwin = macOS
         {
            Return (0) // Hides our real EC only when in macOS
         }
         Else
      {
      Return (0x0F)
     }
  }
}
*/ &lt;- REMOVE THIS
</code></pre>
<p>Like above, make sure the path is correct for the External and Scope field.</p>
<h3 id="what-happens-if-device-in-the-dsdt-is-already-named-ec"><a name="what-happens-if-device-in-the-dsdt-is-already-named-ec" class="plugin-anchor" href="#what-happens-if-device-in-the-dsdt-is-already-named-ec"><i class="fa fa-link" aria-hidden="true"></i></a>What happens if device in the DSDT is already named <code>EC</code></h3>
<p>For laptops, you don&apos;t need SSDT-EC at all.</p>
<h3 id="what-happens-if-multiple-pnp0c09-show-up"><a name="what-happens-if-multiple-pnp0c09-show-up" class="plugin-anchor" href="#what-happens-if-multiple-pnp0c09-show-up"><i class="fa fa-link" aria-hidden="true"></i></a>What happens if multiple <code>PNP0C09</code> show up</h3>
<p>When this happens you need to figure out which is the main and which is not, it&apos;s fairly easy to figure out. Check each controller for the following properties:</p>
<ul>
<li><code>_HID</code> (Hardware ID)</li>
<li><code>_CRS</code> (Current Resource Settings)</li>
<li><code>_GPE</code> (General Purpose Events)</li>
</ul>
<p>Note if you have an STA Method as well, see below: <a href="../Desktops/desktop-ec.md#sta-edge-case">STA Edge Case</a></p>
<h3 id="what-happens-if-no-pnp0c09-show-up"><a name="what-happens-if-no-pnp0c09-show-up" class="plugin-anchor" href="#what-happens-if-no-pnp0c09-show-up"><i class="fa fa-link" aria-hidden="true"></i></a>What happens if no <code>PNP0C09</code> show up</h3>
<p>This means you only need to fake an Embedded Controller rather so that AppleBusPowerController will load and handle USB power properly and continue booting. To make the actual SSDT, its <em>almost</em> plug and play as no uncommenting needed. The main thing that needs to be changed:</p>
<ul>
<li>LowPinCount path</li>
<li>PCI path</li>
</ul>
<p>We want to make sure the SSDT hooks into our DSDT correctly so we need to make sure the ACPI path is correct:</p>
<ul>
<li>Finding the LowPinCount path:<ul>
<li>Intel: Search <code>Name (_ADR, 0x001F0000)</code></li>
<li>AMD: Search <code>Name (_ADR, 0x00140003)</code></li>
</ul>
</li>
<li>Finding the PCI path:<ul>
<li>Intel: Search <code>PNP0A08</code> (If multiple show up, use the first one)</li>
<li>AMD: Assume <code>PCI0</code>(most AMD DSDTs don&apos;t declare the PCI path directly)</li>
</ul>
</li>
</ul>
<p><img src="../images/Desktops/lpc.png" alt=""></p>
<p>Once you find out, change <code>PCI0.LPCB</code> to your correct path:</p>
<pre><code class="lang-text">Scope (\_SB.PC00.LPC0) &lt;- Rename this
{
    Device (EC) &lt;- DO NOT RENAME THIS
    {
        Name (_HID, &quot;ACID0001&quot;)  // _HID: Hardware ID
        Method (_STA, 0, NotSerialized)  // _STA: Status
        {
            If (_OSI (&quot;Darwin&quot;))
            {
                Return (0x0F) // Enable our Fake EC only when in macOS
            }
            Else
            {
                Return (Zero)
            }
        }
    }
}
</code></pre>
<p><img src="../images/Desktops/ec.png" alt=""></p>
<p>For those having issues, you can also check <code>Device Manager -&gt; CPU -&gt; BIOS device Name</code>. Windows will only report the main EC so will save you some headache on that</p>
<h3 id="sta-edge-case"><a name="sta-edge-case" class="plugin-anchor" href="#sta-edge-case"><i class="fa fa-link" aria-hidden="true"></i></a>STA Edge Case</h3>
<p><img src="../images/Desktops/sta.png" alt="Credit to rottenpants466"></p>
<p>Do note that if your PNP0C09 device has a <code>Method (_STA</code> already you can skip down to &quot;What happens if no <code>PNP0C09</code> show up?&quot;.
The reason for this is that the real EC is considered disabled already.</p>
<h3 id="correcting-usb-power"><a name="correcting-usb-power" class="plugin-anchor" href="#correcting-usb-power"><i class="fa fa-link" aria-hidden="true"></i></a>Correcting USB Power</h3>
<blockquote>
<p>Hey what about USBX? Do I need to do anything?</p>
</blockquote>
<p>USBX is universal across all systems, it just creates a USBX device that forces USB power properties. This is crucial for fixing Mics, DACs, Webcams, Bluetooth Dongles and other high power draw devices. This is not mandatory to boot but should be added in post-install if not before. Note that it requires the EC functioning correctly and that USBX is only used on skylake+ systems - those on Broadwell and older can ignore.</p>
<h2 id="now-youre-ready-to-compile-the-ssdt"><a name="now-youre-ready-to-compile-the-ssdt" class="plugin-anchor" href="#now-youre-ready-to-compile-the-ssdt"><i class="fa fa-link" aria-hidden="true"></i></a><a href="../Manual/compile.html">Now you&apos;re ready to compile the SSDT!</a></h2>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../Laptops/laptop-disable.html" class="navigation navigation-prev " aria-label="Previous page: Disabling laptop dGPUs">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="plug.html" class="navigation navigation-next " aria-label="Next page: Plugin type">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Embedded Controller","level":"5.1","depth":1,"next":{"title":"Plugin type","level":"5.2","depth":1,"path":"Universal/plug.md","ref":"Universal/plug.md","articles":[]},"previous":{"title":"Disabling laptop dGPUs","level":"4.3","depth":1,"path":"Laptops/laptop-disable.md","ref":"Laptops/laptop-disable.md","articles":[]},"dir":"ltr"},"config":{"plugins":["theme-default","-lunr","-search","search-plus","addcssjs","favicon-plus","anchors","github-buttons","last-modified","medium-zoom"],"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"},"pluginsConfig":{"last-modified":{},"output":"_book","intopic-toc":{"label":"Navigation"},"addcssjs":{"css":[],"js":[]},"medium-zoom":{},"fontsettings":{"theme":"night","family":"sans","size":2},"favicon-plus":{"appleTouchIconPrecomposed152":"","favicon":"","output":"_book"},"highlight":{},"github-edit":{"repo":"dortania/Getting-Started-With-ACPI","branch":"master"},"favicon":"/icons/favicon.ico","appleTouchIconPrecomposed152":"/icons/appleTouchIconPrecomposed152.png","github-buttons":{"buttons":[{"user":"dortania","repo":"Getting-Started-With-ACPI","type":"star","size":"large"}]},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":[]},"theme-default":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"anchors":{},"search-plus":{}},"theme":"default","medium-zoom":{"margin":24,"background":"#363b40","scrollOffset":0},"pdf":{"pageBreaksBefore":"/","headerTemplate":null,"paperSize":"a4","margin":{"right":62,"left":62,"top":36,"bottom":36},"fontSize":12,"fontFamily":"Arial","footerTemplate":null,"chapterMark":"pagebreak","pageNumbers":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"links":{"sharing":{"google":false,"facebook":false,"twitter":false,"weibo":false,"all":false}},"gitbook":"*"},"file":{"path":"Universal/ec-fix.md","mtime":"2020-05-06T04:52:37.288Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-05-06T04:53:33.021Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-medium-zoom/medium-zoom.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-medium-zoom/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    

    </body>
</html>

